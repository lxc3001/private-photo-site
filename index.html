<!doctype html>
<html lang="zh">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Private Photos</title>
    <style>
      body { font-family: system-ui, sans-serif; margin: 24px; }
      .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 14px; }
      .card { display: flex; flex-direction: column; gap: 6px; }
      img { width: 100%; height: 220px; object-fit: cover; border-radius: 12px; background: #111; }
      .cap { color: #666; font-size: 12px; word-break: break-all; }
    </style>
  </head>
  <body>
    <h2>Private Photos</h2>
    <div id="status">Loading...</div>
    <div class="grid" id="grid"></div>

    <script>
      async function main() {
        const status = document.getElementById("status");
        const grid = document.getElementById("grid");

        const res = await fetch("/api/list");
        if (!res.ok) {
          status.textContent = "Failed to load list: " + res.status;
          return;
        }

        const { keys } = await res.json();
        status.textContent = keys.length ? `Loaded ${keys.length} photos` : "No photos yet";

        for (const key of keys) {
          const card = document.createElement("div");
          card.className = "card";

          const img = document.createElement("img");
          img.loading = "lazy";
          img.src = `/api/img?key=${encodeURIComponent(key)}`;

          const cap = document.createElement("div");
          cap.className = "cap";
          cap.textContent = key;

          card.appendChild(img);
          card.appendChild(cap);
          grid.appendChild(card);
        }
      }

      main().catch((e) => {
        document.getElementById("status").textContent = "Error: " + e.message;
      });
    </script>
  </body>
</html>


